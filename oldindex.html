<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>p5rs</title>
  </head>
  <body>
    <canvas
      id="canvas"
      width="1000"
      height="1000"
      style="border: 1px solid black"
    ></canvas>

    <script type="module">
      const canvas = document.getElementById("canvas");
      const context = canvas.getContext("2d");

      window.mouseState = { x: 0, y: 0, isPressed: false };

      document.addEventListener("mousemove", (event) => {
        const rect = canvas.getBoundingClientRect();
        window.mouseState.x = event.clientX - rect.left;
        window.mouseState.y = event.clientY - rect.top;
      });

      document.addEventListener("mousedown", () => {
        window.mouseState.isPressed = true;
      });

      document.addEventListener("mouseup", () => {
        window.mouseState.isPressed = false;
      });

      window.mouseX = () => window.mouseState.x;
      window.mouseY = () => window.mouseState.y;
      window.mouseIsPressed = () => window.mouseState.isPressed;

      import init from "./static/wasm/wasm_canvas.js";
      await init();
      import { setup, draw } from "./static/wasm/wasm_canvas.js";

      setup();

      function animate() {
        draw();
        requestAnimationFrame(animate);
      }
      requestAnimationFrame(animate);
    </script>
  </body>
</html>
